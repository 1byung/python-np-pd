# ============================================
# Day 2 - Part 2: Pandas ê¸°ì´ˆ
# ============================================

import pandas as pd
import numpy as np

print("="*60)
print("Pandas ê¸°ì´ˆ í•™ìŠµ")
print("="*60)
print()

# ============================================
# 1. DataFrame ìƒì„±
# ============================================
print("ğŸ“Œ 1. DataFrame ìƒì„±")
print("-"*60)

# ë”•ì…”ë„ˆë¦¬ì—ì„œ DataFrame ìƒì„± (ê°€ì¥ ë§ì´ ì‚¬ìš©!)
data = {
    'name': ['ì² ìˆ˜', 'ì˜í¬', 'ë¯¼ìˆ˜', 'ì§€í›ˆ', 'ìˆ˜ì§€'],
    'age': [25, 30, 35, 28, 32],
    'city': ['ì„œìš¸', 'ë¶€ì‚°', 'ì„œìš¸', 'ëŒ€êµ¬', 'ì„œìš¸'],
    'score': [85, 92, 78, 88, 95]
}

df = pd.DataFrame(data)
print("DataFrame:\n", df)
print()

# ë¦¬ìŠ¤íŠ¸ì—ì„œ DataFrame ìƒì„±
data_list = [
    ['ì² ìˆ˜', 25, 'ì„œìš¸', 85],
    ['ì˜í¬', 30, 'ë¶€ì‚°', 92],
    ['ë¯¼ìˆ˜', 35, 'ì„œìš¸', 78]
]
df2 = pd.DataFrame(data_list, columns=['name', 'age', 'city', 'score'])
print("ë¦¬ìŠ¤íŠ¸ì—ì„œ ìƒì„±:\n", df2)
print()

# ============================================
# 2. ë°ì´í„° í™•ì¸
# ============================================
print("ğŸ“Œ 2. ë°ì´í„° í™•ì¸")
print("-"*60)

print("ì²˜ìŒ 3í–‰:")
print(df.head(3))
print()

print("ë§ˆì§€ë§‰ 2í–‰:")
print(df.tail(2))
print()

print("ë°ì´í„° ì •ë³´:")
print(df.info())
print()

print("ê¸°ì´ˆ í†µê³„:")
print(df.describe())
print()

print("shape (í–‰, ì—´):", df.shape)
print("columns (ì—´ ì´ë¦„):", df.columns.tolist())
print("index (ì¸ë±ìŠ¤):", df.index.tolist())
print()

# ============================================
# 3. ì—´(Column) ì„ íƒ
# ============================================
print("ğŸ“Œ 3. ì—´ ì„ íƒ")
print("-"*60)

# í•œ ê°œ ì—´ ì„ íƒ (Series ë°˜í™˜)
print("name ì—´:")
print(df['name'])
print("íƒ€ì…:", type(df['name']))
print()

# ì—¬ëŸ¬ ì—´ ì„ íƒ (DataFrame ë°˜í™˜)
print("nameê³¼ score ì—´:")
print(df[['name', 'score']])
print()

# ì  í‘œê¸°ë²• (ê³µë°± ì—†ëŠ” ì—´ ì´ë¦„ë§Œ)
print("age ì—´ (ì  í‘œê¸°ë²•):")
print(df.age)
print()

# ============================================
# 4. í–‰(Row) ì„ íƒ
# ============================================
print("ğŸ“Œ 4. í–‰ ì„ íƒ")
print("-"*60)

# ì¸ë±ìŠ¤ë¡œ ì„ íƒ (iloc - ìœ„ì¹˜ ê¸°ë°˜)
print("ì²« ë²ˆì§¸ í–‰ (iloc[0]):")
print(df.iloc[0])
print()

print("0~2ë²ˆ í–‰ (iloc[0:3]):")
print(df.iloc[0:3])
print()

# ë¼ë²¨ë¡œ ì„ íƒ (loc - ë¼ë²¨ ê¸°ë°˜)
print("0ë²ˆ ë¼ë²¨ í–‰ (loc[0]):")
print(df.loc[0])
print()

# íŠ¹ì • ìœ„ì¹˜ ê°’ ì„ íƒ
print("0í–‰ name ì—´ ê°’:", df.loc[0, 'name'])
print("1í–‰ score ì—´ ê°’:", df.iloc[1, 3])
print()

# ============================================
# 5. ì¡°ê±´ í•„í„°ë§ (NumPyì™€ ë¹„ìŠ·!)
# ============================================
print("ğŸ“Œ 5. ì¡°ê±´ í•„í„°ë§")
print("-"*60)

# ë‹¨ì¼ ì¡°ê±´
print("ë‚˜ì´ê°€ 30 ì´ìƒ:")
print(df[df['age'] >= 30])
print()

# ì—¬ëŸ¬ ì¡°ê±´ (AND)
print("ì„œìš¸ì— ì‚´ê³  ì ìˆ˜ê°€ 80 ì´ìƒ:")
print(df[(df['city'] == 'ì„œìš¸') & (df['score'] >= 80)])
print()

# ì—¬ëŸ¬ ì¡°ê±´ (OR)
print("ë‚˜ì´ê°€ 25 ì´í•˜ì´ê±°ë‚˜ 35 ì´ìƒ:")
print(df[(df['age'] <= 25) | (df['age'] >= 35)])
print()

# isin() - ì—¬ëŸ¬ ê°’ ì¤‘ í•˜ë‚˜
print("ì„œìš¸ ë˜ëŠ” ë¶€ì‚°ì— ì‚¬ëŠ” ì‚¬ëŒ:")
print(df[df['city'].isin(['ì„œìš¸', 'ë¶€ì‚°'])])
print()

# ============================================
# 6. ìƒˆ ì—´ ì¶”ê°€ ë° ì‚­ì œ
# ============================================
print("ğŸ“Œ 6. ì—´ ì¶”ê°€/ì‚­ì œ")
print("-"*60)

# ìƒˆ ì—´ ì¶”ê°€
df['grade'] = ['B', 'A', 'C', 'B', 'A']
print("grade ì—´ ì¶”ê°€:")
print(df)
print()

# ê³„ì‚°ìœ¼ë¡œ ì—´ ì¶”ê°€
df['age_10_later'] = df['age'] + 10
print("age_10_later ì—´ ì¶”ê°€:")
print(df)
print()

# ì¡°ê±´ìœ¼ë¡œ ì—´ ì¶”ê°€
df['pass'] = df['score'] >= 80
print("pass ì—´ ì¶”ê°€ (80ì  ì´ìƒ True):")
print(df)
print()

# ì—´ ì‚­ì œ
df = df.drop('age_10_later', axis=1)  # axis=1: ì—´ ë°©í–¥
print("age_10_later ì—´ ì‚­ì œ:")
print(df)
print()

# ì—¬ëŸ¬ ì—´ ì‚­ì œ
df = df.drop(['grade', 'pass'], axis=1)
print("grade, pass ì—´ ì‚­ì œ:")
print(df)
print()

# ============================================
# 7. ì •ë ¬
# ============================================
print("ğŸ“Œ 7. ì •ë ¬")
print("-"*60)

# ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
print("ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ:")
print(df.sort_values('score', ascending=False))
print()

# ë‚˜ì´ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
print("ë‚˜ì´ ì˜¤ë¦„ì°¨ìˆœ:")
print(df.sort_values('age'))
print()

# ì—¬ëŸ¬ ì—´ë¡œ ì •ë ¬
print("ë„ì‹œ ì˜¤ë¦„ì°¨ìˆœ â†’ ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ:")
print(df.sort_values(['city', 'score'], ascending=[True, False]))
print()

# ============================================
# 8. ê·¸ë£¹í™” (groupby)
# ============================================
print("ğŸ“Œ 8. ê·¸ë£¹í™”")
print("-"*60)

# ë„ì‹œë³„ í‰ê·  ì ìˆ˜
print("ë„ì‹œë³„ í‰ê·  ì ìˆ˜:")
print(df.groupby('city')['score'].mean())
print()

# ë„ì‹œë³„ í†µê³„
print("ë„ì‹œë³„ ì ìˆ˜ í†µê³„:")
print(df.groupby('city')['score'].describe())
print()

# ë„ì‹œë³„ ì—¬ëŸ¬ í†µê³„
print("ë„ì‹œë³„ ë‚˜ì´ì™€ ì ìˆ˜ í‰ê· :")
print(df.groupby('city')[['age', 'score']].mean())
print()

# ë„ì‹œë³„ ê°œìˆ˜
print("ë„ì‹œë³„ ì¸ì› ìˆ˜:")
print(df.groupby('city').size())
print()

# ============================================
# 9. ê²°ì¸¡ì¹˜ ì²˜ë¦¬
# ============================================
print("ğŸ“Œ 9. ê²°ì¸¡ì¹˜ ì²˜ë¦¬")
print("-"*60)

# ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” ë°ì´í„° ìƒì„±
data_with_na = {
    'name': ['A', 'B', 'C', 'D', 'E'],
    'age': [25, np.nan, 35, 28, np.nan],
    'score': [85, 92, np.nan, 88, 95]
}
df_na = pd.DataFrame(data_with_na)
print("ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” ë°ì´í„°:\n", df_na)
print()

# ê²°ì¸¡ì¹˜ í™•ì¸
print("ê²°ì¸¡ì¹˜ ì—¬ë¶€:\n", df_na.isnull())
print()

print("ê° ì—´ì˜ ê²°ì¸¡ì¹˜ ê°œìˆ˜:")
print(df_na.isnull().sum())
print()

# ê²°ì¸¡ì¹˜ ì±„ìš°ê¸°
df_filled = df_na.fillna(0)
print("0ìœ¼ë¡œ ì±„ìš°ê¸°:\n", df_filled)
print()

# í‰ê· ìœ¼ë¡œ ì±„ìš°ê¸°
df_na['age'] = df_na['age'].fillna(df_na['age'].mean())
print("ageë¥¼ í‰ê· ìœ¼ë¡œ ì±„ìš°ê¸°:\n", df_na)
print()

# ê²°ì¸¡ì¹˜ í–‰ ì‚­ì œ
df_clean = df_na.dropna()
print("ê²°ì¸¡ì¹˜ í–‰ ì‚­ì œ:\n", df_clean)
print()

# ============================================
# 10. CSV íŒŒì¼ ì½ê¸°/ì“°ê¸°
# ============================================
print("ğŸ“Œ 10. CSV íŒŒì¼")
print("-"*60)

# CSVë¡œ ì €ì¥
df.to_csv('students.csv', index=False, encoding='utf-8-sig')
print("CSV íŒŒì¼ ì €ì¥ ì™„ë£Œ: students.csv")

# CSV ì½ê¸°
df_read = pd.read_csv('students.csv', encoding='utf-8-sig')
print("CSV íŒŒì¼ ì½ê¸°:\n", df_read)
print()

# ============================================
# ì‹¤ìŠµ ë¬¸ì œ
# ============================================
print("="*60)
print("ğŸ“ ì‹¤ìŠµ ë¬¸ì œ")
print("="*60)

# ë¬¸ì œ ë°ì´í„°
students = pd.DataFrame({
    'name': ['ê¹€ì² ìˆ˜', 'ì´ì˜í¬', 'ë°•ë¯¼ìˆ˜', 'ì •ì§€í›ˆ', 'ìµœìˆ˜ì§€', 'ê°•ë¯¼ì§€', 'ìœ¤íƒœì–‘', 'ì„í•˜ëŠ˜'],
    'age': [23, 25, 22, 26, 24, 23, 25, 22],
    'city': ['ì„œìš¸', 'ë¶€ì‚°', 'ì„œìš¸', 'ëŒ€êµ¬', 'ì„œìš¸', 'ë¶€ì‚°', 'ì„œìš¸', 'ëŒ€êµ¬'],
    'math': [85, 92, 78, 88, 95, 82, 90, 75],
    'english': [90, 88, 85, 92, 89, 78, 86, 88],
    'science': [88, 90, 82, 85, 92, 85, 88, 80]
})

print("\në°ì´í„°:\n", students)
print()

# ë¬¸ì œ 1: ìˆ˜í•™ ì ìˆ˜ê°€ 85ì  ì´ìƒì¸ í•™ìƒë“¤ì„ ì„ íƒí•˜ì„¸ìš”
print("\n[ë¬¸ì œ 1] ìˆ˜í•™ ì ìˆ˜ 85ì  ì´ìƒ")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
# df[df['age'] >= 30]
result = students[students['math'] >= 85]
print(result)

# ë¬¸ì œ 2: ì„œìš¸ì— ì‚´ê³  ì˜ì–´ ì ìˆ˜ê°€ 85ì  ì´ìƒì¸ í•™ìƒ
print("\n[ë¬¸ì œ 2] ì„œìš¸ ê±°ì£¼ & ì˜ì–´ 85ì  ì´ìƒ")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
result = None
print(result)

# ë¬¸ì œ 3: ì´ì (math + english + science) ì—´ì„ ì¶”ê°€í•˜ì„¸ìš”
print("\n[ë¬¸ì œ 3] ì´ì  ì—´ ì¶”ê°€")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
# students['total'] = ?
print(students)

# ë¬¸ì œ 4: í‰ê· (ì´ì /3) ì—´ì„ ì¶”ê°€í•˜ì„¸ìš”
print("\n[ë¬¸ì œ 4] í‰ê·  ì—´ ì¶”ê°€")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
# students['average'] = ?
print(students)

# ë¬¸ì œ 5: ì´ì ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•˜ì„¸ìš”
print("\n[ë¬¸ì œ 5] ì´ì  ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
result = None
print(result)

# ë¬¸ì œ 6: ë„ì‹œë³„ ìˆ˜í•™ ì ìˆ˜ í‰ê· ì„ êµ¬í•˜ì„¸ìš”
print("\n[ë¬¸ì œ 6] ë„ì‹œë³„ ìˆ˜í•™ í‰ê· ")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
result = None
print(result)

# ë¬¸ì œ 7: ë„ì‹œë³„ í•™ìƒ ìˆ˜ë¥¼ êµ¬í•˜ì„¸ìš”
print("\n[ë¬¸ì œ 7] ë„ì‹œë³„ í•™ìƒ ìˆ˜")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
result = None
print(result)

# ë¬¸ì œ 8: ë‚˜ì´ê°€ 23ì„¸ì¸ í•™ìƒë“¤ì˜ í‰ê·  ì ìˆ˜ë¥¼ êµ¬í•˜ì„¸ìš”
print("\n[ë¬¸ì œ 8] 23ì„¸ í•™ìƒë“¤ì˜ í‰ê· ")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
result = None
print(result)

# ë¬¸ì œ 9: ìˆ˜í•™, ì˜ì–´, ê³¼í•™ ì ìˆ˜ê°€ ëª¨ë‘ 80ì  ì´ìƒì¸ í•™ìƒ
print("\n[ë¬¸ì œ 9] ëª¨ë“  ê³¼ëª© 80ì  ì´ìƒ")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
result = None
print(result)

# ë¬¸ì œ 10: ì„œìš¸ ë˜ëŠ” ë¶€ì‚°ì— ì‚¬ëŠ” í•™ìƒ ì¤‘ ì´ì  ìƒìœ„ 3ëª…
print("\n[ë¬¸ì œ 10] ì„œìš¸/ë¶€ì‚° ê±°ì£¼ ì´ì  ìƒìœ„ 3ëª…")
# TODO: ì—¬ê¸°ì— ì½”ë“œ ì‘ì„±
result = None
print(result)

print("\n" + "="*60)
print("ğŸ’¡ Pandas í•µì‹¬ ì •ë¦¬")
print("="*60)
print("""
1. DataFrame ìƒì„±: pd.DataFrame(data)
2. ë°ì´í„° í™•ì¸: .head(), .tail(), .info(), .describe()
3. ì—´ ì„ íƒ: df['col'], df[['col1', 'col2']]
4. í–‰ ì„ íƒ: df.iloc[0], df.loc[0]
5. ì¡°ê±´ í•„í„°ë§: df[df['col'] > 10]
   - AND: (ì¡°ê±´1) & (ì¡°ê±´2)
   - OR: (ì¡°ê±´1) | (ì¡°ê±´2)
6. ì—´ ì¶”ê°€: df['new_col'] = values
7. ì •ë ¬: df.sort_values('col', ascending=False)
8. ê·¸ë£¹í™”: df.groupby('col')['col2'].mean()
9. ê²°ì¸¡ì¹˜: .isnull(), .fillna(), .dropna()
10. CSV: pd.read_csv(), df.to_csv()
""")
